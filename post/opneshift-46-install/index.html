<!DOCTYPE html>
<html>
  <head lang="zh">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"/>
<meta content="yes" name="apple-mobile-web-app-capable"/>
<meta content="black" name="apple-mobile-web-app-status-bar-style"/>
<meta content="telephone=no" name="format-detection"/>
<meta name="renderer" content="webkit">
<meta name="description" content="绝圣弃智，大盗乃止">
<meta http-equiv="Access-Control-Allow-Origin" content="*">

<title>Opne Shift 4.6在线安装 | すいかの幻想郷</title>
<link href="https://suika.rumia.ml/styles/main.css" type="text/css" rel="stylesheet"/>
<link rel="stylesheet" href="//cdn.bootcss.com/KaTeX/0.10.2/katex.min.css"/>
<script src="//cdn.bootcss.com/KaTeX/0.10.2/katex.min.js"></script>
<script src="//cdn.bootcss.com/KaTeX/0.10.2/contrib/auto-render.min.js"></script>
<script type="text/javascript" src="https://suika.rumia.ml/media/scripts/jquery.js"></script>
<script type="text/javascript" src="https://suika.rumia.ml/media/scripts/jquery.pjax.min.js"></script>
<script type="text/javascript" src="https://suika.rumia.ml/media/scripts/basic.js"></script>
<script type="text/javascript" src="//cdn.bootcss.com/gitalk/1.5.0/gitalk.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.15.10/highlight.min.js"></script>
<script async type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script type="text/javascript" src="https://cdn.bootcss.com/lightgallery/1.6.12/js/lightgallery.min.js"></script>
<script src="https://cdn.bootcss.com/tocbot/4.8.1/tocbot.js"></script>

  </head>
  <body>
     <div class="header">
      <div class="logo_title">
		  
        <div class="title animated fadeInDown"><img id="img1" alt="logo" style="display:inline-block;" src="https://suika.rumia.ml/images/avatar.png"/>
<script>
var r = 0;
    window.onload = function(){
        var current = 0;
        document.getElementById('img1').onclick = function(){
            current = (current+90)%360;
            this.style.transform = 'rotate('+current+'deg)';
        }
    };
</script>

          <h1 title="すいかの幻想郷" class="weaklink"><a  href="/">すいかの幻想郷</a>

          </h1>
	  

          <div class="navbar weaklink">
            <div class="normal_nav">

<div class="bitcron_nav_container">


  <div class="bitcron_nav">
    <div class="mixed_site_nav_wrap site_nav_wrap">
		
      <ul class="mixed_site_nav site_nav sm sm-base">
	  
 
  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="https://suika.rumia.ml" class="selected active current nav__item" >Home</a>
  </li>
  
 
  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="https://suika.rumia.ml/archives" class="selected active current nav__item" >Archives</a>
  </li>
  
 
  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="https://suika.rumia.ml/tags" class="selected active current nav__item" >Tags</a>
  </li>
  
 
  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="https://tg.sakuya.ml/" class="selected active current nav__item" >TG Channel</a>
  </li>
  
 
 <li>

      </ul>
	  

      <div class="clear clear_nav_inline_end"></div>
    </div>

  </div>



  <div class="clear clear_nav_end"></div>

</div>

            </div>
			
			<div class="hamberger"><i class="fa fa-bars"></i>
<i class="fa fa-times"></i>

			</div>

          </div>

        </div>

      </div>

      <div class="hidden_nav animated fadeInDown">

<div class="bitcron_nav_container">


  <div class="bitcron_nav">
    <div class="mixed_site_nav_wrap site_nav_wrap">
      <ul class="mixed_site_nav site_nav sm sm-base">
	
  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="https://suika.rumia.ml" class="selected active current nav__item" >Home</a>

  </li>


  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="https://suika.rumia.ml/archives" class="selected active current nav__item" >Archives</a>

  </li>


  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="https://suika.rumia.ml/tags" class="selected active current nav__item" >Tags</a>

  </li>


  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="https://tg.sakuya.ml/" class="selected active current nav__item" >TG Channel</a>

  </li>




      </ul>

      <div class="clear clear_nav_inline_end"></div>
    </div>

  </div>



  <div class="clear clear_nav_end"></div>

</div>

      </div>

    </div>




    <div class="main" id="pjax-container">
      <div class="main-inner">
<div class="content">
<div class="post_page" >
<div class="post">
  <div class="post_title sm_margin">
    <h2><a>Opne Shift 4.6在线安装</a>
    </h2>
  </div>
<script>
function lan(){
	if (document.getElementById("lan").innerText == "繁"){
		var s=document.getElementById("tongwenlet_cn");
		if(s != null){
		document.body.removeChild(s);
		}
		var s = document.createElement("script");
		s.language = "javascript";
		s.type = "text/javascript";
		s.src = "https://git.oschina.net/runningcheese/JiathisQR.js/raw/master/bookmarklet_tw.js";
		s.id = "tongwenlet_cn";
		document.body.appendChild(s);
		document.getElementById("lan").innerHTML = "简"
	}
	else if(document.getElementById("lan").innerText == "簡"){
		var s=document.getElementById("tongwenlet_cn");
		if(s != null){
		document.body.removeChild(s);
		}
		var s = document.createElement("script");
		s.language = "javascript";
		s.type = "text/javascript";
		s.src = "https://git.oschina.net/runningcheese/JiathisQR.js/raw/master/bookmarklet_cn.js";
		s.id = "tongwenlet_cn";
		document.body.appendChild(s);
		document.getElementById("lan").innerHTML = "繁"
		}
}

function change(){	
    var rand = Math.random()*1+1;
    var num = window.getComputedStyle(document.getElementsByName("show")[0],undefined).fontSize;
	num = num.slice(0,-2); 
    document.getElementById("show").style.fontSize = num - rand +'px';
}
</script>
  <div class="post_details">
    <div class="round-shape-one" ></div>
    <div class="info"><i class="fa fa-calendar"></i>
<span class="date_info">2020-12-12</span>
<i class="fa fa-eye"></i>
<span class="date_info"><span id="busuanzi_value_page_pv"></span> Views</span>
<i class="fa fa-bookmark-o"></i>
<span class="tags_info weaklink">
	
	<a href="https://suika.rumia.ml/tag/YRNFJB3K3/" class="tag">Openshift</a>

</span>
<i class="fa fa-anchor"></i>
<span style="margin-right:15px">
3428字
</span>
<i class="fa fa-clock-o"></i>
<span style="margin-right:15px">
20 min read
</span>
<span style="margin-right:15px">
</span>
<span style="margin-right:15px">
<a id="daxiao" href="javascript:void(0);" onclick="change();" title="调整字体大小"><i class="fa fa-font"></i></a>
</span>
<span style="margin-right:15px">
<a id="lan" href="javascript:void(0);" onclick="lan();" title="调整简繁体">繁</a>
</span>
</div>
  </div>

    <div class="post_content markdown">
	
    <div name="show" id="show">
	<p class="md_block"><span class="md_line md_line_start md_line_end"><h2 id="规划">规划</h2>
<h3 id="架构">架构：</h3>
<h3 id="服务器信息">服务器信息：</h3>
<table>
<thead>
<tr>
<th>用途</th>
<th>主机名</th>
<th>IP</th>
</tr>
</thead>
<tbody>
<tr>
<td>Master1</td>
<td>ocpmaster01.suika.com</td>
<td>10.90.16.21</td>
</tr>
<tr>
<td>Work1</td>
<td>ocpwork01.suika.com</td>
<td>10.90.16.22</td>
</tr>
<tr>
<td>Work2</td>
<td>ocpwork02.suika.com</td>
<td>10.90.16.23</td>
</tr>
<tr>
<td>bootstrap</td>
<td>bootstrap.ocpsuika.com</td>
<td>10.90.18.19</td>
</tr>
<tr>
<td>bastion</td>
<td>bastion.suika.com</td>
<td>10.90.18.16</td>
</tr>
</tbody>
</table>
<h3 id="域名信息">域名信息：</h3>
<table>
<thead>
<tr>
<th>用途</th>
<th>域名</th>
<th>地址</th>
<th>端口</th>
</tr>
</thead>
<tbody>
<tr>
<td>Kubernetes API</td>
<td>api.ocp.suika.com</td>
<td>10.90.18.19</td>
<td>6443</td>
</tr>
<tr>
<td>Kubernetes API</td>
<td>api-int.suika.com</td>
<td>10.90.18.19</td>
<td>443</td>
</tr>
<tr>
<td>Routes</td>
<td>*.apps.suika.com</td>
<td>10.90.18.19</td>
<td>443</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>域名</th>
<th>IP</th>
<th>端口</th>
<th>用途</th>
</tr>
</thead>
<tbody>
<tr>
<td>console-openshift-console.apps.ocp.suika.com</td>
<td>10.90.16.21</td>
<td>443</td>
<td>OCP控制台页面</td>
</tr>
<tr>
<td>oauth-openshift.apps.ocp.suika.com</td>
<td>10.90.16.21</td>
<td>443</td>
<td>OCP oauth登录跳转页面</td>
</tr>
<tr>
<td>prometheus-k8s-openshift-monitoring.apps.ocp.suika.com</td>
<td>10.90.16.21</td>
<td>443</td>
<td>Prometheus</td>
</tr>
<tr>
<td>kibana-openshift-logging.apps.ocp.suika.com</td>
<td>10.90.16.21</td>
<td>443</td>
<td>Kibana</td>
</tr>
<tr>
<td>api.ocp.suika.com</td>
<td>10.90.16.21</td>
<td>6443</td>
<td>API</td>
</tr>
</tbody>
</table>
<h3 id="端口列表">端口列表：</h3>
<table>
<thead>
<tr>
<th>协议</th>
<th>端口</th>
<th>用途</th>
</tr>
</thead>
<tbody>
<tr>
<td>TCP</td>
<td>2379-2380</td>
<td>etcd server, peer, and metrics ports</td>
</tr>
<tr>
<td>TCP</td>
<td>6443</td>
<td>Kubernetes API</td>
</tr>
<tr>
<td>TCP</td>
<td>10249-10259</td>
<td>The default ports that Kubernetes reserves</td>
</tr>
<tr>
<td>TCP</td>
<td>10256</td>
<td>openshift-sdn</td>
</tr>
<tr>
<td>TCP</td>
<td>9000-9999</td>
<td>Host level services, including the node exporter on ports 9100-9101 and the Cluster Version Operator on port 9099.</td>
</tr>
<tr>
<td>UDP</td>
<td>4789、6081</td>
<td>VXLAN and GENEVE</td>
</tr>
<tr>
<td>UDP</td>
<td>9000-9999</td>
<td>Host level services, including the node exporter on ports 9100-9101.</td>
</tr>
<tr>
<td>TCP/UDP</td>
<td>30000-32767</td>
<td>Kubernetes NodePort</td>
</tr>
</tbody>
</table>
<h2 id="环境准备">环境准备：</h2>
<h3 id="离线资源">离线资源：</h3>
<p>pull secret <a href="https://cloud.redhat.com/openshift/install/metal/installer-provisioned">下载地址</a><br>
OpenShift CLI（OC）<a href="https://access.redhat.com/downloads/content/290/ver=4.6/rhel---8/4.6.3/x86_64/product-software">下载地址</a><br>
Openshift-install CLI <a href="https://access.redhat.com/downloads/content/290/ver=4.6/rhel---8/4.6.3/x86_64/product-software">下载地址</a><br>
CoreOS image <a href="https://mirror.openshift.com/pub/openshift-v4/dependencies/rhcos/4.6/4.6.1/">下载地址</a></p>
<h3 id="安装openshift-cli并创建目录">安装OpenShift CLI并创建目录：</h3>
<pre><code># tar xvzf oc-4.6.3-linux.tar.gz
# tar xvzf openshift-install-linux-4.6.3.tar.gz
# mv oc kubectl openshift-install /usr/local/bin
# mkdir -p /opt/install
# touch /opt/install/install-config.yaml
</code></pre>
<h3 id="dns配置">DNS配置：</h3>
<pre><code>[root@bastion ~]# yum install dnsmasq -y

[root@bastion ~]# cat /etc/dnsmasq.d/ocp.conf 
address=/bastion.suika.com/10.90.18.16
address=/api.ocp.suika.com/10.90.18.16
address=/.apps.ocp.suika.com/10.90.18.16
address=/api-int.ocp.suika.com/10.90.18.16
address=/ocpmaster01.ocp.suika.com/10.90.16.21
address=/ocpmaster02.ocp.suika.com/10.90.16.22
address=/ocpmaster03.ocp.suika.com/10.90.16.23
address=/bootstrap.ocp.suika.com/10.19.18.19
address=/registry.suika.com/10.90.18.9
address=/oauth-openshift.ocp.suika.com/10.90.18.16
ptr-record=21.16.90.10.in-addr.arpa,ocpmaster01.ocp.suika.com
ptr-record=22.16.90.10.in-addr.arpa,ocpmaster02.ocp.suika.com
ptr-record=23.16.90.10.in-addr.arpa,ocpmaster03.ocp.suika.com
ptr-record=19.18.90.10.in-addr.arpa,bootstrap.ocp.suika.com
srv-host=_etcd-server-ssl._tcp.ocp.suika.com,etcd-0.ocp.suika.com,2380,10
srv-host=_etcd-server-ssl._tcp.ocp.suika.com,etcd-1.ocp.suika.com,2380,10
srv-host=_etcd-server-ssl._tcp.ocp.suika.com,etcd-2.ocp.suika.com,2380,10
</code></pre>
<p>启动服务：</p>
<pre><code>[root@bastion ~]# systemctl start dnsmasq.service
[root@bastion ~]# systemctl status dnsmasq.service 
● dnsmasq.service - DNS caching server.
   Loaded: loaded (/usr/lib/systemd/system/dnsmasq.service; enabled; vendor preset: disabled)
   Active: active (running) since Fri 2020-12-11 23:03:19 CST; 2 weeks 3 days ago
 Main PID: 46638 (dnsmasq)
   CGroup: /system.slice/dnsmasq.service
           └─46638 /usr/sbin/dnsmasq -k

</code></pre>
<h3 id="配置haproxy">配置haproxy：</h3>
<pre><code>[root@bastion ~]# yum install haproxy -y
[root@bastion ~]# vim /etc/haproxy/haproxy.cfg
global

    log         127.0.0.1 local2

    chroot      /var/lib/haproxy
    pidfile     /var/run/haproxy.pid
    maxconn     4000
    user        haproxy
    group       haproxy
    daemon

    # turn on stats unix socket
    stats socket /var/lib/haproxy/stats

#---------------------------------------------------------------------
# common defaults that all the 'listen' and 'backend' sections will
# use if not designated in their block
#---------------------------------------------------------------------
defaults
    mode                    http
    log                     global
    option                  httplog
    option                  dontlognull
    option http-server-close
    option forwardfor       except 127.0.0.0/8
    option                  redispatch
    retries                 3
    timeout http-request    10s
    timeout queue           1m
    timeout connect         10s
    timeout client          1m
    timeout server          1m
    timeout http-keep-alive 10s
    timeout check           10s
    maxconn                 3000

listen stats
    bind :9000
    mode http
    stats enable
    stats uri /
    monitor-uri /healthz

frontend openshift-api-server
    bind *:6443
    default_backend openshift-api-server
    mode tcp
    option tcplog

backend openshift-api-server
    balance source
    mode tcp
    server bootstrap 10.90.18.19:6443 check
    server master-0 10.90.16.21:6443 check
    server master-1 10.90.16.22:6443 check
    server master-2 10.90.16.23:6443 check

frontend machine-config-server
    bind *:22623
    default_backend machine-config-server
    mode tcp
    option tcplog

backend machine-config-server
    balance source
    mode tcp
    server bootstrap 10.90.18.19:22623 check
    server master-0 10.90.16.21:22623 check
    server master-0 10.90.16.22:22623 check
    server master-0 10.90.16.23:22623 check

frontend ingress-http
    bind *:80
    default_backend ingress-http
    mode tcp
    option tcplog

backend ingress-http
    balance source
    mode tcp
    server worker-1 10.90.16.22:80 check
    server worker-2 10.90.16.23:80 check
    server worker-3 10.90.16.21:80 check

frontend ingress-https
    bind *:443
    default_backend ingress-https
    mode tcp
    option tcplog

backend ingress-https
    balance source
    mode tcp
    server worker-1 10.90.16.22:443 check
    server worker-2 10.90.16.23:443 check
    server worker-3 10.90.16.21:443 check
	
</code></pre>
<p>查看服务状态：</p>
<pre><code>[root@bastion ~]# systemctl start haproxy.service

[root@bastion ~]# systemctl status haproxy.service 
● haproxy.service - HAProxy Load Balancer
   Loaded: loaded (/usr/lib/systemd/system/haproxy.service; enabled; vendor preset: disabled)
   Active: active (running) since Fri 2020-12-11 22:55:58 CST; 2 weeks 3 days ago
 Main PID: 46295 (haproxy-systemd)
   CGroup: /system.slice/haproxy.service
           ├─46295 /usr/sbin/haproxy-systemd-wrapper -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid
           ├─46296 /usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -Ds
           └─46297 /usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -Ds
</code></pre>
<h3 id="配置http服务器">配置http服务器：</h3>
<pre><code>[root@bastion ~]# yum install httpd -y
[root@bastion ~]# mkdir -p /var/www/html/install/
[root@bastion ~]# ln -s /opt/install/ /var/www/html/install
</code></pre>
<p>同样启动服务并检查状态：</p>
<pre><code>[root@bastion ~]# systemctl start httpd.service；systemctl status httpd.service
</code></pre>
<h2 id="安装过程">安装过程：</h2>
<h3 id="生成密钥待用">生成密钥待用：</h3>
<pre><code> ssh-keygen -t rsa -b 2048 -N &quot;&quot; -f /root/.ssh/id_rsa ；cat /root/.ssh/id_rsa.pub 
</code></pre>
<h3 id="编辑install文件">编辑install文件：</h3>
<p>把下载的pull-secret.txt及上面的文件加到默认的install-config.yaml后面，并且配置proxy<br>
注意：noproxy中按“，”分隔</p>
<pre><code>[root@bastion ~]# cat /opt/install-config.yaml 
apiVersion: v1
baseDomain: suika.com 
proxy:
  httpProxy: http://suika:suika@proxy@suika.com:8080 
  noProxy: .suika.com,.suika.com,.ocp.suika.com,10.90.16.0/22
compute:
- hyperthreading: Enabled   
  name: worker
  replicas: 0 
controlPlane:
  hyperthreading: Enabled   
  name: master 
  replicas: 3
metadata:
  name: ocp
networking:
  clusterNetwork:
  - cidr: 10.128.0.0/14 
    hostPrefix: 23 
  networkType: OpenShiftSDN
  serviceNetwork: 
  - 172.30.0.0/16
platform:
  none: {} 
fips: false 
pullSecret: '{&quot;auths&quot;:{&quot;cloud.openshift.com&quot;:{&quot;auth&quot;:&quot;b3BlbnNoaWZ0LXJlbGVhc2UtZGV2K2N1aXNvbmd0YW9oM2Njb20xdnY2YjdzZ3FodWxyYjBiYXhucThxbW51b2s6WUYyQ1I1UTNNV1NFU1dLVVNEME8zNUo4UkVRUjI3QVBURDVIUkVWRVpEUExRSUJFOE85U0dFWE81QlRQNVo2VQ==&quot;,&quot;email&quot;:&quot;suika@suika.com&quot;},&quot;quay.io&quot;:{&quot;auth&quot;:&quot;b3BlbnNoaWZ0LXJlbGVhc2UtZGV2K2N1aXNvbmd0YW9oM2Njb20xdnY2YjdzZ3FodWxyYjBiYXhucThxbW51b2s6WUYyQ1I1UTNNV1NFU1dLVVNEME8zNUo4UkVRUjI3QVBURDVIUkVWRVpEUExRSUJFOE85U0dFWE81QlRQNVo2VQ==&quot;,&quot;email&quot;:&quot;suika@suika.com&quot;},&quot;registry.connect.redhat.com&quot;:{&quot;auth&quot;:&quot;NzYxMDE1Mnx1aGMtMVZWNmI3c0dxaFVMcmIwYkF4blE4cU1OVU9LOmV5SmhiR2NpT2lKU1V6VXhNaUo5LmV5SnpkV0lpT2lJMU1tWTROR05tWm1Nd01EQTBOelV5WVdVNU16WmxaVGhrTkROaFlUbGhNeUo5LlJiT1g3Ml9qY21fVTZLSFdVMS1VT19YTUk0aXVuSXZ3SVRWa1dsUDZ2QlU0Qzl0U2pickltM1FuY2Q4WENjeUVoQWY5cUoxVXRtWHlVWk5JODZ3dEo1eVE1STZnU3FlZ2RBMEZ2ek1tQk9qUzZ6eHAxVm83ZmNfVG1oYzBQSERhSWVudlhTZ3BscnNaUWpRckllVUNlUlNuaGRGdDFSdHU0djFaMDh1V1N4Y3k4VGI0dXIyNmRXZWhUSUF6Q0R2aFNkRzBhUVZaRExOYVd5QTE2YjIwSEdFYVNRNmlXUDNQZ05tUWFmTkdyUnNOTFZYd01Qd0ZQU01YMkdsVGhmMXludEpiTXl3UEx1a3pzaEozeFJ3bkFFV0JIdGd2dVlDNUN2YjB1SFlUMDJWVUV1Q21hbDBBQkppUlo4LVdiOV9RZEgxcXNKQzBGRGFUa2dhSjhzSWpleE9qTWtRWVZCeHI4OGpNNVcta0xlbmhLQmRxMTladHFiWTdwMGd0S0JjWjFQczlkSWJRRzJKSTVUZEZza2suika1VDeHdYM1o2QVlBeGJyR2ItSHVBRi1PT0pTdVBKU3RNMDJPblBHdGVRaUVSd0ZOMUZNZjEwRmxjQktlRTIyUGR1SU1sN3gyWTIxalJMR3VZdHBZa0FWVUZ1UEdMM3l3ZVFsWGk4RWYxVG9FV2kwU0dpWXFaNEt1ZWNLVjhUWFhWNHJCUTJSNHhZQmVwZ1F5d2xPNWdiU0xNQ0IwNzkxUlAtRXFyUlNadkJhbERjSlRfbzNxNlk5VWYtYnRuaVBjeTY0bkIxUHZmakxwazNqY0tBdWtBVHZDZjhrUmJKRVkwOFVWQXVpZENadFZiZDByWXpXNS1TUDN3VC10ZGhTb2h5OWNvZ2xTWkZ6aXhlYmJFdkNmalBJ&quot;,&quot;email&quot;:&quot;suika@suika.com&quot;},&quot;registry.redhat.io&quot;:{&quot;auth&quot;:&quot;NzYxMDE1Mnx1aGMtMVZWNmI3c0dxaFVMcmIwYkF4blE4cU1OVU9LOmV5SmhiR2NpT2lKU1V6VXhNaUo5LmV5SnpkV0lpT2lJMU1tWTROR05tWm1Nd01EQTBOelV5WVdVNU16WmxaVGhrTkROaFlUbGhNeUo5LlJiT1g3Ml9qY21fVTZLSFdVMS1VT19YTUk0aXVuSXZ3SVRWa1dsUDZ2QlU0Qzl0U2pickltM1FuY2Q4WENjeUVoQWY5cUoxVXRtWHlVWk5JODZ3dEo1eVE1STZnU3FlZ2RBMEZ2ek1tQk9qUzZ6eHAxVm83ZmNfVG1oYzBQSERhSWVudlhTZ3BscnNaUWpRckllVUNlUlNuaGRGdDFSdHU0djFaMDh1V1N4Y3k4VGI0dXIyNmRXZWhUSUF6Q0R2aFNkRzBhUVZaRExOYVd5QTE2YjIwSEdFYVNRNmlXUDNQZ05tUWFmTkdyUnNOTFZYd01Qd0ZQU01YMkdsVGhmMXludEpiTXl3UEx1a3pzaEozeFJ3bkFFV0JIdGd2dVlDNUN2YjB1SFlUMDJWVUV1Q21hbDBBQkppUlo4LVdiOV9RZEgxcXNKQzBGRGFUa2dhSjhzSWpleE9qTWtRWVZCeHI4OGpNNVcta0xlbmhLQmRxMTladHFiWTdwMGd0S0JjWjFQczlkSWJRRzJKSTVUZEZza2suika1VDeHdYM1o2QVlBeGJyR2ItSHVBRi1PT0pTdVBKU3RNMDJPblBHdGVRaUVSd0ZOMUZNZjEwRmxjQktlRTIyUGR1SU1sN3gyWTIxalJMR3VZdHBZa0FWVUZ1UEdMM3l3ZVFsWGk4RWYxVG9FV2kwU0dpWXFaNEt1ZWNLVjhUWFhWNHJCUTJSNHhZQmVwZ1F5d2xPNWdiU0xNQ0IwNzkxUlAtRXFyUlNadkJhbERjSlRfbzNxNlk5VWYtYnRuaVBjeTY0bkIxUHZmakxwazNqY0tBdWtBVHZDZjhrUmJKRVkwOFVWQXVpZENadFZiZDByWXpXNS1TUDN3VC10ZGhTb2h5OWNvZ2xTWkZ6aXhlYmJFdkNmalBJ&quot;,&quot;email&quot;:&quot;suika@suika.com&quot;}}}' 
sshKey: 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDnfEBthXuNhuE/3dnGHEfzB9I2aYVmJUMe25sxL9BsX02tj+OA4H30j30tB4hD+AWrP3PEnt8zdD25ggGu1lGE4Ckt38uhMYud/a+amr5oTcIfIYlj/f9mo8VwKzehx7K7G8JWnFXwPjln97MuM/QVg6S+DY2wvGCSG+6MFwrq4/OCBlu1qjyoaE6yMl510n3rOB1WrUcj/LCiHBTsCsytx4fmtbSLxUxMyl3nfA83zhATg+meHKFtLpIEGZbMib7diI8APcOlEX4lOOwqf0lI6bFfTy2pRJ2cLAJXLvQaJL4eOhTOMqzbquj3g+gzkqpMf2R9L/fDTP5pwQqIkJjd root@bastion' 
[root@bastion ~]# cp /opt/install-config.yaml /opt/install/install-config.yaml 
</code></pre>
<h3 id="创建配置">创建配置：</h3>
<pre><code>[root@bastion ~]# openshift-install create manifests --dir=/opt/install
INFO Consuming Install Config from target directory 
WARNING Making control-plane schedulable by setting MastersSchedulable to true for Scheduler cluster settings 
INFO Manifests created in: /opt/install/manifests and /opt/install/openshift 

[root@bastion ~]# openshift-install create ignition-configs --dir=/opt/install/
INFO Consuming Common Manifests from target directory 
INFO Consuming Master Machines from target directory 
INFO Consuming OpenShift Install (Manifests) from target directory 
INFO Consuming Openshift Manifests from target directory 
INFO Consuming Worker Machines from target directory 
INFO Ignition-Configs created in: /opt/install and /opt/install/auth
</code></pre>
<p>现在的目录结构是这样：</p>
<pre><code>[root@bastion ~]# tree /opt/install
/opt/install
├── auth
│   ├── kubeadmin-password
│   └── kubeconfig
├── bootstrap.ign
├── bootstrap.sh
├── master.ign
├── master.sh
├── metadata.json
└── worker.ign

1 directory, 8 files
</code></pre>
<h3 id="创建安装脚本">创建安装脚本：</h3>
<p>环境比较特殊，不能搭DHCP所以无法pxe安装，只能配置静态IP，又懒得改镜像，所以就琢磨出这么个办法安装。<br>
注意脚本中的<code>'rd.neednet=1'</code>否则启动的时候有可能主机名变为localhost</p>
<pre><code>[root@bastion ~]# cat /var/www/html/install/bootstrap.sh
#!/bin/bash
/bin/coreos-installer install --copy-network --insecure-ignition --ignition-url=http://10.90.18.16:8080/install/bootstrap.ign --firstboot-args 'rd.neednet=1' /dev/vda

[root@bastion ~]# cat /var/www/html/install/master.sh
#!/bin/bash
/bin/coreos-installer install --copy-network --insecure-ignition --ignition-url=http://10.90.18.16:8080/install/master.ign --firstboot-args 'rd.neednet=1' /dev/sda

</code></pre>
<h3 id="启动设备">启动设备：</h3>
<p>打开设备电源并在ilo挂载rhcos镜像：<br>
<img src="https://suika.rumia.ml/post-images/1609291406688.png" alt="" loading="lazy"><br>
<img src="https://suika.rumia.ml/post-images/1609291424913.png" alt="" loading="lazy"><br>
<img src="https://suika.rumia.ml/post-images/1609291432187.png" alt="" loading="lazy"><br>
用nmtui配置网络，生效后检查是否获取到主机名<br>
下载上面的安装脚本进行安装：<br>
<img src="https://suika.rumia.ml/post-images/1609291401163.png" alt="" loading="lazy"></p>
<h3 id="重启设备进行安装">重启设备进行安装：</h3>
<p>安装完成后先重启bootstrap，待其重启完成后，并检查有pod后重启三台master主机。</p>
<pre><code>[core@bootstrap ~]$ sudo crictl pods
POD ID              CREATED              STATE               NAME                                                           NAMESPACE                             ATTEMPT
519ca2107ede7       33 seconds ago       Ready               bootstrap-kube-scheduler-bootstrap.ocp.suika.com             kube-system                           0
ee3682d35720d       33 seconds ago       Ready               bootstrap-kube-controller-manager-bootstrap.ocp.suika.com    kube-system                           0
4832d0632a339       33 seconds ago       Ready               bootstrap-kube-apiserver-bootstrap.ocp.suika.com             kube-system                           0
1e6aa212b904d       33 seconds ago       Ready               cloud-credential-operator-bootstrap.ocp.suika.com            openshift-cloud-credential-operator   0
4fc5ec6c6e443       33 seconds ago       Ready               bootstrap-cluster-version-operator-bootstrap.ocp.suika.com   openshift-cluster-version             0
fee62b862de12       50 seconds ago       Ready               bootstrap-machine-config-operator-bootstrap.ocp.suika.com    default                               0
f7b83eedcfbc6       About a minute ago   Ready               etcd-bootstrap-member-bootstrap.ocp.suika.com                openshift-etcd                        0
[core@bootstrap ~]$ ss -tulnp|grep 6443
tcp     LISTEN   0        128                    *:6443                 *:*     
[core@bootstrap ~]$ ss -tulnp|grep 22623
tcp     LISTEN   0        128                    *:22623                *:*   
</code></pre>
<p>重启master的时候需要盯着点ilo，启动完成后虽然可以获取到正确的主机名，但还是要把主机名修改一下，不然后面再重启主机名可能又变回localhost了。</p>
<pre><code>[root@bastion ~]# ssh core@10.90.16.23
The authenticity of host '10.90.16.23 (10.90.16.23)' can't be established.
ECDSA key fingerprint is SHA256:9ZehCh3XkLlk86xu43DiSnIk8bT14UfPGc+dlxX6qzg.
ECDSA key fingerprint is MD5:a7:d7:2c:58:5d:8c:42:44:ec:fa:b0:b8:76:86:7f:14.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '10.90.16.23' (ECDSA) to the list of known hosts.
Red Hat Enterprise Linux CoreOS 46.82.202010091720-0
  Part of OpenShift 4.6, RHCOS is a Kubernetes native operating system
  managed by the Machine Config Operator (`clusteroperator/machine-config`).

WARNING: Direct SSH access to machines is not recommended; instead,
make configuration changes via `machineconfig` objects:
  https://docs.openshift.com/container-platform/4.6/architecture/architecture-rhcos.html

---
[core@ocpmaster03 ~]$ hostname
ocpmaster03.ocp.suika.com
[core@ocpmaster03 ~]$ sudo hostnamectl set-hostname ocpmaster03.ocp.suika.com

</code></pre>
<h3 id="等待安装完成">等待安装完成：</h3>
<p>此后剩下的就是等待安装完成，大概要一杯咖啡的时间：</p>
<pre><code>[root@bastion ~]# openshift-install --dir=/opt/install wait-for bootstrap-complete --log-level=debug
DEBUG OpenShift Installer 4.6.4                    
DEBUG Built from commit 6e02d049701437fa81521fe981405745a62c86c5 
INFO Waiting up to 20m0s for the Kubernetes API at https://api.ocp.suika.com:6443... 
INFO API v1.19.0+9f84db3 up                       
INFO Waiting up to 30m0s for bootstrapping to complete... 
</code></pre>
<p>至此可以移除bootstrap节点，并把haproxy中关于bootstrap的信息注释掉，并重启haproxy，然后继续等待安装完成：</p>
<pre><code>[root@bastion ~]# oc get node
NAME                          STATUS   ROLES           AGE    VERSION
ocpmaster01.ocp.suika.com   Ready    master,worker   2m     v1.19.0+9f84db3
ocpmaster02.ocp.suika.com   Ready    master,worker   5m9s   v1.19.0+9f84db3
ocpmaster03.ocp.suika.com   Ready    master,worker   10m    v1.19.0+9f84db3
[root@bastion install]# openshift-install --dir=/opt/install wait-for install-complete --log-level debug
DEBUG OpenShift Installer 4.6.4                    
DEBUG Built from commit 6e02d049701437fa81521fe981405745a62c86c5 
DEBUG Loading Install Config...                    
DEBUG   Loading SSH Key...                         
DEBUG   Loading Base Domain...                     
DEBUG     Loading Platform...                      
DEBUG   Loading Cluster Name...                    
DEBUG     Loading Base Domain...                   
DEBUG     Loading Platform...                      
DEBUG   Loading Pull Secret...                     
DEBUG   Loading Platform...                        
DEBUG Using Install Config loaded from state file  
INFO Waiting up to 40m0s for the cluster at https://api.ocp.suika.com:6443 to initialize... 
DEBUG Cluster is initialized                       
INFO Waiting up to 10m0s for the openshift-console route to be created... 
DEBUG Route found in openshift-console namespace: console 
DEBUG Route found in openshift-console namespace: downloads 
DEBUG OpenShift console route is created           
INFO Install complete!                            
INFO To access the cluster as the system:admin user when using 'oc', run 'export KUBECONFIG=/opt/install/auth/kubeconfig' 
INFO Access the OpenShift web-console here: https://console-openshift-console.apps.ocp.suika.com 
INFO Login to the console with user: &quot;kubeadmin&quot;, and password: &quot;XviuD-bnp8Y-RNYxL-zcp8R&quot; 
INFO Time elapsed: 0s  
</code></pre>
<p>注意这个输出的kubeadmin用户及其密码，后面console登录会用到</p>
<h2 id="安装后的工作">安装后的工作：</h2>
<p>到上面那个输出openshift就已经安装完成了，做一点额外的工作</p>
<h3 id="检查状态">检查状态：</h3>
<pre><code>[root@bastion ~]# oc get co
NAME                                       VERSION   AVAILABLE   PROGRESSING   DEGRADED   SINCE
authentication                             4.6.4     True        False         False      90s
cloud-credential                           4.6.4     True        False         False      37m
cluster-autoscaler                         4.6.4     True        False         False      21m
config-operator                            4.6.4     True        False         False      22m
console                                    4.6.4     True        False         False      8m50s
csi-snapshot-controller                    4.6.4     True        False         False      22m
dns                                        4.6.4     True        False         False      20m
etcd                                       4.6.4     True        False         False      15m
image-registry                             4.6.4     True        False         False      12m
ingress                                    4.6.4     True        False         False      12m
insights                                   4.6.4     True        False         False      22m
kube-apiserver                             4.6.4     True        False         False      15m
kube-controller-manager                    4.6.4     True        False         False      20m
kube-scheduler                             4.6.4     True        False         False      16m
kube-storage-version-migrator              4.6.4     True        False         False      20m
machine-api                                4.6.4     True        False         False      21m
machine-approver                           4.6.4     True        False         False      21m
machine-config                             4.6.4     True        False         False      20m
marketplace                                4.6.4     True        False         False      20m
monitoring                                 4.6.4     True        False         False      10m
network                                    4.6.4     True        False         False      23m
node-tuning                                4.6.4     True        False         False      22m
openshift-apiserver                        4.6.4     True        False         False      11m
openshift-controller-manager               4.6.4     True        False         False      19m
openshift-samples                          4.6.4     True        False         False      12m
operator-lifecycle-manager                 4.6.4     True        False         False      21m
operator-lifecycle-manager-catalog         4.6.4     True        False         False      21m
operator-lifecycle-manager-packageserver   4.6.4     True        False         False      12m
service-ca                                 4.6.4     True        False         False      22m
storage                                    4.6.4     True        False         False      22m
</code></pre>
<h3 id="获取console地址">获取console地址：</h3>
<pre><code>[root@bastion ~]# oc get route -A |grep openshift
openshift-authentication   oauth-openshift     oauth-openshift.apps.ocp.suika.com                                 oauth-openshift     6443       passthrough/Redirect   None
openshift-cnv              test-maven-app      test-maven-app-openshift-cnv.apps.ocp.suika.com                    test-maven-app      8080-tcp                          None
openshift-console          console             console-openshift-console.apps.ocp.suika.com                       console             https      reencrypt/Redirect     None
openshift-console          downloads           downloads-openshift-console.apps.ocp.suika.com                     downloads           http       edge/Redirect          None
openshift-monitoring       alertmanager-main   alertmanager-main-openshift-monitoring.apps.ocp.suika.com          alertmanager-main   web        reencrypt/Redirect     None
openshift-monitoring       grafana             grafana-openshift-monitoring.apps.ocp.suika.com                    grafana             https      reencrypt/Redirect     None
openshift-monitoring       prometheus-k8s      prometheus-k8s-openshift-monitoring.apps.ocp.suika.com             prometheus-k8s      web        reencrypt/Redirect     None
openshift-monitoring       thanos-querier      thanos-querier-openshift-monitoring.apps.ocp.suika.com             thanos-querier      web        reencrypt/Redirect     None
openshift                  nodejs-sample       nodejs-sample-openshift.apps.ocp.suika.com                         nodejs-sample       8080-tcp                          None
</code></pre>
<p>添加上面的域名解析到任意一个master或haproxy的虚地址，然后就可以用web登录了，用前面的kubeadmin用户及密码</p>
<h3 id="配置时钟同步服务">配置时钟同步服务：</h3>
<p>通过浏览器登录到open shift的console之后，就会发现一个告警，集群没有配置NTP服务，然而又翻了一遍安装文档还是没地方讲这玩意怎么配。<br>
找了一下红帽的官网，发现解决的办法有两个，一个就是在主机启动后尽快登录，然后配置ntp服务，就是在重启后修改主机名的时候一并修改了NTP，然而这是什么鬼方案，如果不是环境不允许谁没事盯着ilo看启动到哪一步了……<br>
合理的是采用第二种方案：<br>
1、创建base64格式的chrony.conf</p>
<pre><code>cat &lt;&lt; EOF | base64 -w 0
server suikantp02-in.suika.com iburst
driftfile /var/lib/chrony/drift
makestep 1.0 3
rtcsync
logdir /var/log/chrony
EOF
</code></pre>
<p>2、创建99_masters-chrony-configuration.yaml文件，并写入上面的信息：</p>
<pre><code>[root@bastion opt]# cat 99_masters-chrony-configuration.yaml 
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: master
  name: masters-chrony-configuration
spec:
  config:
    ignition:
      config: {}
      security:
        tls: {}
      timeouts: {}
      version: 2.2.0
    networkd: {}
    passwd: {}
    storage:
      files:
      - contents:
          source: data:text/plain;charset=utf-8;base64,c2VydmVyIGgzY250cDAyLWluLmgzYy5jb20gaWJ1cnN0CmRyaWZ0ZmlsZSAvdmFyL2xpYi9jaHJvbnkvZHJpZnQKbWFrZXN0ZXAgMS4wIDMKcnRjc3luYwpsb2dkaXIgL3Zhci9sb2cvY2hyb255Cg==
          verification: {}
        filesystem: root
        mode: 420
        path: /etc/chrony.conf
  osImageURL: &quot;&quot;
</code></pre>
<p>如果有worker节点创建一个类似的99_workers-chrony-configuration.yaml的文件。</p>
<p>3、应用文件：</p>
<pre><code>oc apply -f 99_masters-chrony-configuration.yaml
</code></pre>
<p>等一会，登录到任意主机，检查一下chrony的状态已是修改后的状态：</p>
<pre><code>[core@ocpmaster03 ~]$ cat /etc/chrony.conf 
server suikantp02-in.suika.com iburst
driftfile /var/lib/chrony/drift
makestep 1.0 3
rtcsync
logdir /var/log/chrony
[core@ocpmaster03 ~]$ timedatectl 
               Local time: Mon 2020-12-14 08:12:01 UTC
           Universal time: Mon 2020-12-14 08:12:01 UTC
                 RTC time: Mon 2020-12-14 08:12:01
                Time zone: UTC (UTC, +0000)
System clock synchronized: yes
              NTP service: active
          RTC in local TZ: no
</code></pre>
<p>至此，集群搭建完毕。</p>
<h2 id="参考文档">参考文档：</h2>
<p>https://access.redhat.com/solutions/4906341<br>
https://misa.gitbook.io/k8s-ocp-yaml/openshift-docs/<br>
https://docs.openshift.com/container-platform/4.6/installing/installing_bare_metal/installing-bare-metal.html</p>
</span></p></div><div id = "warn"></div>
	<br>
	<hr>
<div style="color: #ccc;font-size:14px;"><i class="fa fa-user"></i>本文由<a rel="license" href="/">すいかの幻想郷</a>创作，转载请注明出处！</div>	

<div class="reward"><div class="reward-button">赏 <span class="reward-code"> <span class="alipay-code"> <img class="alipay-img" alt = "support" src="https://suika.rumia.ml/media/images/alipay.png"><b>支付宝扫码打赏</b> </span> <span class="wechat-code"> <img alt ="support" class="wechat-img" src="https://suika.rumia.ml/media/images/wechat.png"><b>微信打赏</b> </span> </span></div></div>
<div style="text-align:center;color: #ccc;font-size:14px;">如果觉得这篇文章对您有帮助，可以请作者喝一杯饮料哦🥤</div>    
</div>
</div>

<style type="text/css">
#mememe {
	border:3px;
	border-radius:5px;
    background-repeat: no-repeat;
    height: 100%;
	width: 100%;
	display: inline-block;
	border-radius:5px; 
}
</style>

<div style="width:100%;overflow:hidden">

          <div style="float:right;text-align:right;color:#ccc;font-size:18px;width:50%;">
            Next
            <a href="https://suika.rumia.ml/post/brocade-switch/">
              <p class="post-title">
                <b>记一次博科光交排障</b>
              </p>
            </a>
          </div>



          <div style="float:left;text-align:left;color:#ccc;font-size:18px;width:50%;">
            Previous
            <a href="https://suika.rumia.ml/post/Operation-not-permitted/">
              <p class="post-title">
                <b>Too many open files导致登录失败</b>
              </p>
            </a>
          </div>

</div>
<div class="doc_comments">

          
			<div id="gitalk-container"></div>
            <link href="https://cdn.bootcss.com/gitalk/1.5.0/gitalk.min.css" rel="stylesheet">
<script>
  var gitalk = new Gitalk({
    clientID: '4ed2d0f2177557660943',
    clientSecret: 'a269fb9ee0fb1f96e9b81c0f1e2bd7a09254b0fc',
    repo: 'suikascarlet/Comments',
    owner: 'suikascarlet',
    admin: ['suikascarlet'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })
  gitalk.render('gitalk-container')
</script>


          
			  
          
        
</div>
<script>
var link="";$("img").each((i,o)=>{var o=$(o);if(o.attr("src").indexOf("sinaimg")>0||o.attr("src").indexOf("qpic")>0||o.attr("src").indexOf("baidu")>0||o.attr("src").indexOf("sinaimg")>0){o.attr("referrerpolicy","no-referrer");link=o.attr("src");o.attr("src",link);}});
imgList = document.querySelectorAll('.md_block img')
imgList.forEach(img => {
  if (img.alt !== "logo" && img.alt !== "featureimg"){
  let div1 = document.createElement('div')
  let div = document.createElement('div')
  div.className='back';
  div.setAttribute("data-src",img.src)
  var figuration = document.createElement("figcaption")
  figuration.innerHTML = '<a href="' + img.src + '">' + img.alt + '</a>'
  img.replaceWith(div1)
  div1.appendChild(div)
  div.appendChild(img)
  div1.appendChild(figuration)}
})
$('img').on('error',function(){$(this).prop('src','https://suika.rumia.ml/media/images/broken.jpg')});$(".md_block a").attr("rel","external nofollow");$("a[rel='external nofollow']").attr("target","_blank");$("a[href^='#']").removeAttr("target");$("a.ex").removeAttr("rel");$("a.ex").removeAttr("target");
content="<div class='warn'>本文最后更新于2020-12-12，已超过 1 年没有更新，涉及的内容可能已经失效！</div>";var date1="2020-12-12 09:14:40";date1=date1.replace("-","/");var date2=new Date();var date3=date2.getTime()-new Date(date1).getTime();var days=Math.floor(date3/(24*3600*1000));if(days>=365){document.getElementById("warn").innerHTML=content};
$('#pjax-container').lightGallery({
    selector: '.back'
});
</script>
  </div>
</div>


      </div>
<div class="toc">
<ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E8%A7%84%E5%88%92">规划</a>
<ul>
<li><a href="#%E6%9E%B6%E6%9E%84">架构：</a></li>
<li><a href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BF%A1%E6%81%AF">服务器信息：</a></li>
<li><a href="#%E5%9F%9F%E5%90%8D%E4%BF%A1%E6%81%AF">域名信息：</a></li>
<li><a href="#%E7%AB%AF%E5%8F%A3%E5%88%97%E8%A1%A8">端口列表：</a></li>
</ul>
</li>
<li><a href="#%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87">环境准备：</a>
<ul>
<li><a href="#%E7%A6%BB%E7%BA%BF%E8%B5%84%E6%BA%90">离线资源：</a></li>
<li><a href="#%E5%AE%89%E8%A3%85openshift-cli%E5%B9%B6%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95">安装OpenShift CLI并创建目录：</a></li>
<li><a href="#dns%E9%85%8D%E7%BD%AE">DNS配置：</a></li>
<li><a href="#%E9%85%8D%E7%BD%AEhaproxy">配置haproxy：</a></li>
<li><a href="#%E9%85%8D%E7%BD%AEhttp%E6%9C%8D%E5%8A%A1%E5%99%A8">配置http服务器：</a></li>
</ul>
</li>
<li><a href="#%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B">安装过程：</a>
<ul>
<li><a href="#%E7%94%9F%E6%88%90%E5%AF%86%E9%92%A5%E5%BE%85%E7%94%A8">生成密钥待用：</a></li>
<li><a href="#%E7%BC%96%E8%BE%91install%E6%96%87%E4%BB%B6">编辑install文件：</a></li>
<li><a href="#%E5%88%9B%E5%BB%BA%E9%85%8D%E7%BD%AE">创建配置：</a></li>
<li><a href="#%E5%88%9B%E5%BB%BA%E5%AE%89%E8%A3%85%E8%84%9A%E6%9C%AC">创建安装脚本：</a></li>
<li><a href="#%E5%90%AF%E5%8A%A8%E8%AE%BE%E5%A4%87">启动设备：</a></li>
<li><a href="#%E9%87%8D%E5%90%AF%E8%AE%BE%E5%A4%87%E8%BF%9B%E8%A1%8C%E5%AE%89%E8%A3%85">重启设备进行安装：</a></li>
<li><a href="#%E7%AD%89%E5%BE%85%E5%AE%89%E8%A3%85%E5%AE%8C%E6%88%90">等待安装完成：</a></li>
</ul>
</li>
<li><a href="#%E5%AE%89%E8%A3%85%E5%90%8E%E7%9A%84%E5%B7%A5%E4%BD%9C">安装后的工作：</a>
<ul>
<li><a href="#%E6%A3%80%E6%9F%A5%E7%8A%B6%E6%80%81">检查状态：</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96console%E5%9C%B0%E5%9D%80">获取console地址：</a></li>
<li><a href="#%E9%85%8D%E7%BD%AE%E6%97%B6%E9%92%9F%E5%90%8C%E6%AD%A5%E6%9C%8D%E5%8A%A1">配置时钟同步服务：</a></li>
</ul>
</li>
<li><a href="#%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3">参考文档：</a></li>
</ul>
</li>
</ul>

</div>
    </div>
	
   <div class="footer">
<div class="site_footer_wrap"><div class="site_footer">

      <div class="mysocials"><div class="my_socials">
		   
			   
<a href="https://t.me/touhoumichong" title="telegram"><i class="fa fa-telegram"></i></a>

    
			   
    
			   
    
			   
    
			   
<a href="mailto:i@rumia.ml" title="envelope"><i class="fa fa-envelope"></i></a>

    
			   
    
</div>
      </div>

      <div class="copyright" id="copyright">
	  <script>
		var date=new Date;
		var year=date.getFullYear(); 
		document.write("Copyright © 2018-"+year+" " + "すいかの幻想郷. ");
		</script>
		<br>
		本站已稳定运行了
		<strong><script type="text/javascript">
		var urodz= new Date("01/01/2020");
		var now = new Date();
		var ile = now.getTime() - urodz.getTime();
		var dni = Math.floor(ile / (1000 * 60 * 60 * 24));
		document.write(+dni)
		</script>
		</strong>天
		<br>
		记录是最好的反抗
	  
      </div>
	 

    </div>

<script type="text/javascript" src="https://suika.rumia.ml/media/scripts/darkmode.js"></script>
<script>
new Darkmode({label: '🌓',backgroundColor: '#f7f7f7',time: '0.5s'}).showWidget();
console.clear();
console.log("\n %c \u26a1Theme: Bitcron-pro Author's Blog:https://blog.blinkstar.cn  Writen By Serence  \n\n", "color: #ffffff; background: rgba(49, 49, 49, 0.85); padding:5px 0;border-radius:5px;", );
</script>
<script>
hljs.initHighlightingOnLoad();
</script>


</body>

</html>
